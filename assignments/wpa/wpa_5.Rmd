---
title: "WPA #5  -- Plotting with ggplot2"
output: html_document
---


```{r global_options, include=FALSE}
knitr::opts_chunk$set(fig.width=12, fig.height=8,
                      echo=FALSE, warning=FALSE, message=FALSE, eval=FALSE)
```


## Readings

This assignment is based on the following readings:

- R for Data Science: [Data Visualization](http://r4ds.had.co.nz/data-visualisation.html), [Exploratory Data Analysis](http://r4ds.had.co.nz/exploratory-data-analysis.html)

## Assignment Goals

- Create histograms, barplots, boxplots, and scatterplots with ggplot2
- Save plots to a file


# Examples

```{r, echo = TRUE, eval = FALSE}
library(tidyverse)   # Load tidyverse packages
library(yarrr)       # Load yarrr package (for pirates data)
library(jtools)      # Load jtools (for theme_apa())

# Set theme (try different themes and see how the plots change)

theme_set(theme_apa())
#or
theme_set(theme_bw())
# or
theme_set(theme_minimal())

# Histogram

## Default
ggplot(data = pirates,
        aes(x = height)) + 
        geom_histogram()

## With customisations
ggplot(data = pirates,
        aes(x = height)) + 
        geom_histogram(colour = "black", 
                       fill = "white", 
                       bins = 15) + 
  labs(x = "Height (cm)",
       y = "Frequency") + 
  scale_x_continuous(breaks = seq(100, 250, 10),  # Set custom x axis
                     limits = c(120, 250)) +     
  scale_y_continuous(breaks = seq(0, 300, 50),    # Set custom 7 axis
                     limits = c(0, 300)) +
   geom_vline(xintercept = mean(pirates$height),     # Add vertical line at mean
              col = "red") + 
  geom_text(mapping = aes(x = mean(pirates$height), 
                          y = 300, 
                          label = "Mean"), 
            nudge_x = 7)  # Move text a bit to the right
  

# Continuous IV, Continuous DV
# Scatterplot

ggplot(data = pirates,
       aes(x = height, y = weight)) +
  geom_point()

# With customisations

ggplot(data = pirates,
       aes(x = height, y = weight, col = sex)) +
  geom_point(alpha = .2) + 
  geom_smooth(method = "lm", colour = "blue") +
  theme(panel.grid.major = element_line(colour = gray(.9)))


# Discrete IV, Continuous DV

### Violin plot
ggplot(data = pirates,
       aes(x = factor(fav.pixar), y = tchests)) + 
         geom_violin() + 
  labs(x = "Favorite Pixar Movie",
       y = "Treasure Chests")

### Boxplot
ggplot(data = pirates,
       aes(x = sword.type, y = tchests, fill = sword.type)) + 
         geom_boxplot() + 
  labs(x = "Favorite Sword",
       y = "Treasure chests") +
  guides(fill = FALSE) # Turn off legend for filling  

### Barplot

pirates_agg <- pirates %>% 
  group_by(headband, sex) %>%
  summarise(
    tchests_mean = mean(tchests),
    tchests_lb = t.test(tchests)$conf.int[1],
    tchests_ub = t.test(tchests)$conf.int[2]
  )

## Simple

ggplot(data = pirates_agg,
       aes(x = headband, y = tchests_mean)) + 
  geom_bar(stat = "identity") + 
  labs(y = "Mean treasure chests found")


# Grouped barplot with error bars

ggplot(data = pirates_agg,
       aes(x = headband, y = tchests_mean, fill = sex)) + 
  geom_bar(stat = "identity", position = position_dodge(0.9), col = "white") + 
  geom_errorbar(aes(ymax = tchests_lb,
                    ymin = tchests_ub), 
                position = position_dodge(0.9), 
                width = 0.25) + 
  labs(y = "Treasure chests found")

```


## It's personal: : The effect of personal value on utilitarian moral judgments

```{r, echo = TRUE, eval = TRUE}
knitr::include_graphics("images/millarscreen.png")
```



In this WPA, we will analyze data from Millar et al. (2016): It's personal: : The effect of personal value on utilitarian moral judgments. 

Here is the abstract (You can find the full paper at http://journal.sjdm.org/16/16428/jdm16428.pdf):

**We investigated whether the personal importance of objects influences utilitarian decision-making in which damaging property is necessary to produce an overall positive outcome. In Experiment 1, participants judged saving five objects by destroying a sixth object to be less acceptable when the action required destroying the sixth object directly (rather than as a side-effect) and the objects were personally important (rather than unimportant). In Experiment 2, we demonstrated that utilitarian judgments were not influenced by the objects’ monetary worth. Together these findings suggest that personal importance underlies people’s sensitivity to damaging property as a means for utilitarian gains.**

# Data

The original data are stored as csv viles at sjdm.org. However, the data needed some cleaning. The cleaned versions contain the original data, but with better labels and some minor corrections.

### Study 1

- Original: [http://journal.sjdm.org/16/16428/expt1.csv](http://journal.sjdm.org/16/16428/expt1.csv)
- Cleaned [https://dl.dropboxusercontent.com/u/7618380/Millar_study1.txt](https://dl.dropboxusercontent.com/u/7618380/Millar_study1.txt)

Variable | Description 
------------  | ------------------------------------------------------- 
acceptability             | How acceptable is the action? 
important             | Were the objects important to the owner or not?
direct             | Was the destruction of an object a means of saving the others or a side-effect?
cover             | Was the object a poster or a clock?
gender             | Participant gender
age             | Participant Age
storycomp             | Comprehension question 1
itemcomp             | Comprehension question 2
ownercomp             | Comprehension question 3 
failed | Did participant fail an attention check?

### Study 2

- Original: [http://journal.sjdm.org/16/16428/expt2.csv](http://journal.sjdm.org/16/16428/expt2.csv)
- Cleaned [https://dl.dropboxusercontent.com/u/7618380/Millar_study2.txt](https://dl.dropboxusercontent.com/u/7618380/Millar_study2.txt)

Variable | Description 
------------  | ------------------------------------------------------- 
acceptability             | How acceptable is the action? 
important             | Were the objects important to the owner or not?
direct             | Was the destruction of an object a means of saving the others or a side-effect?
expensive             | Was the object expensive or not?
previoustrolley             | Did participants complete a trolley problem in the past?
gender             | Participant gender
age             | Participant Age
topiccomp             | Comprehension question 1
expensivecomp             | Comprehension question 2
importancecomp             | Comprehension question 3 
failed | Did participant fail an attention check?


## Submit!


- Save and email your `wpa_4_LastFirst.R` file to me at nathaniel.phillips@unibas.ch.
- Go to [https://goo.gl/forms/b9dcRH6Ud3pDagOr1](https://goo.gl/forms/b9dcRH6Ud3pDagOr1) to confirm your assignment submission.
