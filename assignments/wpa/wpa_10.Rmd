---
title: "WPA #10  -- Regression"
output: html_document
---

```{r global_options, include=FALSE}
knitr::opts_chunk$set(fig.width=12, fig.height=8,
                      echo=FALSE, warning=FALSE, message=FALSE, eval=TRUE, fig.align = 'center', out.width = "70%")

student_m <- read.table("https://raw.githubusercontent.com/ndphillips/IntroductionR_Course/master/assignments/wpa/data/studentmath.txt",
                      sep = "\t",
                      header = TRUE)

student_p <- read.table("https://raw.githubusercontent.com/ndphillips/IntroductionR_Course/master/assignments/wpa/data/studentpor.txt",
                      sep = "\t",
                      header = TRUE)
```


## Readings

This assignment is based on the following readings:

- [Markdown Video](https://www.youtube.com/watch?v=7qTvOZfK6Cw)
- [Markdown Guide](http://www.rpubs.com/YaRrr/markdownbasics)
- [RStudio Lessons](http://rmarkdown.rstudio.com/lesson-1.html)
- [papaja Guide](https://ndphillips.github.io/IntroductionR_Course/readings/papajaguide.html)

## Assignment Goals

- Create regression objects (`lm` and `glm`) with the `lm()` and `glm()` functions
- Understand the contents of regression objects and interpret outputs.
- Use the `names()` and `summary()` functions to access specific elements of regression objects.

## Examples

```{r, echo = TRUE, eval = FALSE}
library(papaja)   #Load the yarrr package for the pirates dataframe
library(knitr)
```


### Get started

A. In order to render PDF files, you need to have LaTeX installed, follow the instructions at the [papaja guide](https://ndphillips.github.io/IntroductionR_Course/readings/papajaguide.html) to install LaTeX on your computer.

B. Once you have installed LaTeX, install the `papaja` package from GitHub using the following code:

```{r eval = FALSE}

devtools::install_github("crsh/papaja") # Install papaja from GitHub
```


1. Create a new R project called `studentAPA.RProj`.

2. Navigate to the project directory (the one you just put `studentAPA.RProj` in). Create two new folders `R` and `data` in your project directory.

3. In this WPA, you will analyze data from a study on student performance in two classes: math and Portuguese. These data come from the UCI Machine Learning database at http://archive.ics.uci.edu/ml/datasets/Student+Performance#Download. The data are located in two tab-delimited text files at the following locations:

- `studentmath.txt`: https://raw.githubusercontent.com/ndphillips/IntroductionR_Course/master/assignments/wpa/data/studentmath.txt (the math data)

- `studentpor.txt`: https://raw.githubusercontent.com/ndphillips/IntroductionR_Course/master/assignments/wpa/data/studentpor.txt (the Portuguese data). 

Download the two data files using a web browser and save them as two separate text files called `studentmath.txt` and `studentpor.txt`. Save them to the `data` folder of your project directory! (or you can do it within R using a combination of with `read.table()` and `write.table()`).

2. The two data files you ned for this assignment are located at https://raw.githubusercontent.com/ndphillips/IntroductionR_Course/master/assignments/wpa/data/studentmath.txt (the math data) and https://raw.githubusercontent.com/ndphillips/IntroductionR_Course/master/assignments/wpa/data/studentpor.txt (the portugese data). Using `read.table()` load this two data files into R as two objects, one called `student_m`, and one called `student_p`. Then, save the data as text files called `studentmath.txt` and `studentpor.txt` in your data folder:

```{r, echo = FALSE, eval = TRUE}
student.math <- read.table("https://raw.githubusercontent.com/ndphillips/IntroductionR_Course/master/assignments/wpa/data/studentmath.txt",
                      sep = "\t",
                      header = TRUE)

student.por <- read.table("https://raw.githubusercontent.com/ndphillips/IntroductionR_Course/master/assignments/wpa/data/studentpor.txt",
                      sep = "\t",
                      header = TRUE)
```

4. Using a web-browser, download the following two files and save them to your project working directory -- that is, next to the `studentAPA.Rproj` file. **Not** in the `data` or `R` folders.

- `studentAPA_blank.Rmd`: https://raw.githubusercontent.com/ndphillips/IntroductionR_Course/master/assignments/wpa/studentAPA/studentAPA_blank.Rmd

- `studentAPA.bib`: https://raw.githubusercontent.com/ndphillips/IntroductionR_Course/master/assignments/wpa/studentAPA/studentAPA.bib


### STOP!!!

By now you should have a file structure on your computer that looks like the following screenshot (except your .Rmd file will have the name `studentAPA_blank.Rmd`)

```{r}
knitr::include_graphics("https://github.com/ndphillips/IntroductionR_Course/blob/master/assignments/wpa/images/studentAPA_files_ss.png?raw=true")
```


Here is how your RStudio screen should look when you are in the appropriate project. Note that the file structure matches the one on your computer.

```{r}
knitr::include_graphics("https://github.com/ndphillips/IntroductionR_Course/blob/master/assignments/wpa/images/studentAPA_project_ss.png?raw=true")
```


<font color = "red">If you don't have this folder structure and/or you don't have the appropriate project open in RStudio, the rest of the document won't work!</font>

5. Your goal is to create this APA document (https://github.com/ndphillips/IntroductionR_Course/blob/master/assignments/wpa/studentAPA_comp.pdf?raw=true) by adding elements to the `studentAPA_blank.Rmd` document. In a web browser, go to the link above to download the studentAPA_comp.pdf file and see how it looks.

### Adding titles and knitting for the first time

6. Open `studentAPA_blank.Rmd` and `studentAPA.bib` in RStudio. In `studentAPA_blank.Rmd`, replace the X values in the main fields at the top of the document (name, paper title, short-title, affiliation) with the appropriate names and titles.

7. Now *Knit* your document to see the current version of the PDF output! You can do this by clicking the "Knit" button at the top of your window or by using the Command + Shift + K shortcut (on Mac).

### Add references to the .bib file

8. Now it's time to add some references to your `studentAPA.bib` file! You will be referencing three papers in this document. Using scholar.google.com, find the BibTeX references for the following paper(s) and add them to your `studentAPA.bib` file. Make sure to save the file!

- Horwitz, Elaine K., Michael B. Horwitz, and Joann Cope. "Foreign language classroom anxiety." The modern language journal 70.2 (1986): 125-132.

- Collier, V. P. (1992). A synthesis of studies examining long-term language minority student data on academic achievement. Bilingual Research Journal, 16(1-2), 187-212.

- Abedi, J., & Lord, C. (2001). The language factor in mathematics tests. Applied Measurement in Education, 14(3), 219-234.

9. Now it's time to cite your new references. I've included one citation already in the `studentAPA_blank.Rmd` document in the format \@abedi2001language. Now cite the additional papers in your `studentAPA.bib` file by replacing the XXX values with the appropriate citations. **Knit your document to see the result**

### Load data

10. You need to load your data in a separate chunk. I've already created a chunk called `setup` with all the code you need. Of course, This code assumes that your data are stored in `studentmath.txt` and `studentpor.txt` in a folder called `data` in your project directory!. **Knit your document to see the result** If you don't see any errors, then the data should have been correctly loaded!

11. In the Participants section, there are inline code chunks that should indicate the number of participants in each data set. Replace the `1+1` values with `nrow(student.por)` and `nrow(student.math)` to get the number of students in each data set. **Knit your document to see the result**

### Add plots

12. In the Results section, I've included a chunk called fig1 that creates Figure 1, a series of histograms. Update the caption to the plot in the chunk options. Then change `eval = FALSE` to `eval = TRUE` to tell Markdown to run the chunk. **Knit your document to see the result**, You should now see the histograms in your document!

13. There is another chunk called `fig2` that plots the correlations between numeric predictors in the math data. Turn on the chunk by setting `eval = TRUE`, update the caption. **Knit your document to see the result** 

### Add statistics

14. Below the Figure 1 chunk, there are some inline chunks that calculate the mean grades for exam 1 and exam 3 of the Portuguese data. Update these chunks with the correct code to calculate the mean G3 scores for the math and portugese datasets. **Knit your document to see the result**

15. The next two chunks create tables of summary statistics for the Math and Portuguese data. Update the captions in these chunks. Then, change `eval = FALSE` to `eval = TRUE` in the chunk options. **Knit your document to see the result** You should now see the tables in your document.

16. The next chunk conducts and saves t-tests for both the math and Portuguese data. The code for the Portuguese test `sex.por.ttest` is already completed, but the code to create a similar test for the math data is missing. Add the code for the math test to create the object `sex.math.ttest`. Then, change `eval = FALSE` to `eval = TRUE` in the chunk options.

17. The next lines use inline code to refer to the results of your t-test objects. Replace the `1+1` values with  `papaja::apa_print(sex.por.ttest)$full_result` and `papaja::apa_print(sex.math.ttest)$full_result` **Knit your document to see the result**

## Add new analyses!

18. Add a scatterplot showing the relationship between G1 and G3 for the math data as a new Figure 3. **Knit your document to see the result**

19. In addition to your scatterplot, conduct the appropriate correlation test using `cor.test()` in a separate chunk. Save the result as `math.cor.test`

20. Now report the results of your correlation test in your text. You can easily do this using the `apa_print()` function from `papaja`. Look at the help menu for `apa_print()`. Then use the function to report the results of the correlation test by running `apa_print(math.cor.test)`. **Knit your document to see the result**



## Submit!

- Save and email your `wpa_10_LastFirst.R` file to me at nathaniel.phillips@unibas.ch.
- Go to [https://goo.gl/forms/b9dcRH6Ud3pDagOr1](https://goo.gl/forms/b9dcRH6Ud3pDagOr1) to confirm your assignment submission.

